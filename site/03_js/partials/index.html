<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Loading Partial Content Dynamically</title>
<script type="importmap">
{ "imports": {"@cre.ative/kram-11ty/runtime":"../../modules/@cre.ative/kram-11ty/runtime.mjs","@cre.ative/kram-11ty/styles":"../../modules/@cre.ative/kram-11ty/styles.css"} }
</script>
<link rel="stylesheet" href="../../modules/@cre.ative/kram-11ty/styles.css">
<script type="module">
import {init, register} from "@cre.ative/kram-11ty/runtime";
init({});
import("./scenes.html.js")
          .then((mod) => register(mod, "scenes.html.js", "html", (resource, container) => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(resource.default, 'text/html');
            const body = doc.body;
            const scenes = Object.fromEntries(
              Array.prototype.map.call(body.children, (node) => [
              node && node.dataset.scene, node ])
              .filter(([num]) => Boolean(num)));
            return function render (n, container) {
              const scene = scenes[n]
              if( scene ) {
                for( let child = scene.firstElementChild; child; child = scene.firstElementChild ) {
                  if ( child.tagName === 'SCRIPT' ) {
                    const text = child.firstChild
                    scene.removeChild(child)
                    child = document.createElement('script')
                    child.appendChild(text)
                  } 
                  container.appendChild(child) 
                }
              } 
            }
          }))
import("./module.js")
          .then((mod) => register(mod, "Kram_a9f90145_partials", "js", null))
</script>
</head>
<body>
<kram-main>
<h1 slot="title">Loading Partial Content Dynamically</h1>
<kram-toc slot="nav"><ol>
<li data-idref="scene-1">Inserting text into the DOM</li>
<li data-idref="scene-2">Inserting a new element into the DOM</li>
<li data-idref="scene-3">Parsing HTML to insert into the DOM</li>
<li data-idref="scene-4">Fetching content from a server</li>
<li data-idref="scene-5">Fetching HTML from a server</li>
</ol></kram-toc>
<kram-flow><kram-scene 
        scene="1" 
        language="html" 
        ><kram-code slot="scenecode" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>    <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">addText</span><span class="token punctuation">(</span><br>        <span class="token string">'Hello, world! '</span><span class="token punctuation">,</span><br>        event<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><br>  <span class="token punctuation">></span></span><br>    Say it!<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre></kram-code><h1 slot="title">Inserting text into the DOM</h1>

<kram-code data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">addText</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>window<span class="token punctuation">.</span>addText <span class="token operator">=</span> addText<span class="token punctuation">;</span></code></pre></kram-code></kram-scene>
<kram-scene 
        scene="2" 
        language="html" 
        ><kram-code slot="scenecode" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>    <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">addParagraph</span><span class="token punctuation">(</span><br>        <span class="token string">'Hello, world!'</span><span class="token punctuation">,</span><br>        event<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'section'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><br>  <span class="token punctuation">></span></span><br>    Say it!<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span></code></pre></kram-code><h1 slot="title">Inserting a new element into the DOM</h1>

<kram-code data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">addParagraph</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  p<span class="token punctuation">.</span>textContent <span class="token operator">=</span> text<span class="token punctuation">;</span><br>  container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>window<span class="token punctuation">.</span>addParagraph <span class="token operator">=</span> addParagraph<span class="token punctuation">;</span></code></pre></kram-code></kram-scene>
<kram-scene 
        scene="3" 
        language="html" 
        ><kram-code slot="scenecode" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>    <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">addFragment</span><span class="token punctuation">(</span><br>        <span class="token string">'&lt;h1>Hello, &lt;em>world!&lt;/em>&lt;/h1>How do you do?'</span><span class="token punctuation">,</span><br>        event<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'section'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><br>  <span class="token punctuation">></span></span><br>    Say it with HTML!<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span></code></pre></kram-code><h1 slot="title">Parsing HTML to insert into the DOM</h1>

<kram-code data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">addFragment</span><span class="token punctuation">(</span><span class="token parameter">htmlString<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> doc <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parseFromString</span><span class="token punctuation">(</span>htmlString<span class="token punctuation">,</span> <span class="token string">"text/html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> fragment <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>body<span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token operator">...</span>fragment<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>window<span class="token punctuation">.</span>addFragment <span class="token operator">=</span> addFragment<span class="token punctuation">;</span></code></pre></kram-code></kram-scene>
<kram-scene 
        scene="4" 
        language="html" 
        ><kram-code slot="scenecode" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">addTextFrom</span><span class="token punctuation">(</span><br>            <span class="token string">'../FILES/metamorphosis.html'</span><span class="token punctuation">,</span><br>            event<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'code'</span><span class="token punctuation">)</span><br>            <span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><br>        <span class="token punctuation">></span></span> Fetch It! <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span></code></pre></kram-code><h1 slot="title">Fetching content from a server</h1>

<kram-code data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">addTextFrom</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">addText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>window<span class="token punctuation">.</span>addTextFrom <span class="token operator">=</span> addTextFrom<span class="token punctuation">;</span></code></pre></kram-code></kram-scene>
<kram-scene 
        scene="5" 
        language="html" 
        ><kram-code slot="scenecode" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>    <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token function">addFragmentFrom</span><span class="token punctuation">(</span><br>        <span class="token string">'../FILES/metamorphosis.html'</span><span class="token punctuation">,</span><br>        event<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'article'</span><span class="token punctuation">)</span><br>        <span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><br>  <span class="token punctuation">></span></span><br>    Fetch the HTML!<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span></code></pre></kram-code><h1 slot="title">Fetching HTML from a server</h1>

<kram-code data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">addFragmentFrom</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">addFragment</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>window<span class="token punctuation">.</span>addFragmentFrom <span class="token operator">=</span> addFragmentFrom<span class="token punctuation">;</span></code></pre></kram-code></kram-scene></kram-flow>
</kram-main>
</body>
</html>
